let bar_dif1;
let bar_dif2;
let bar_dif3;

let owl1 = $('#posts-slider');
let owl2 = $('#reviews-slider');
let owl3 = $('#similar-slider');
let owl4 = $('#banner-slider');
let owl5 = $('#catalog-banner-slider');
let owl6 = $('#article-gallery');
let owl7 = $('.product-page__nav-list-items');

owl1.owlCarousel({
    touchDrag:true,
    loop: true,
    dots: false,
    nav: false,
    margin: 30,
    onInitialized: carouselInitialized1,
    responsive: {
        0 : {
            items : 1.1480263,
            margin: 10
        },
        500 : {
            items : 1.5,
            margin: 20
        },
        600 : {
            items : 1.8,
            margin: 20
        },
        768 : {
            items : 2.3355932,
            margin: 20
        },
        900 : {
            items : 2.55
        },
        1300 : {
            items : 2.3586206
        },
        1800 : {
            items : 2.2472527
        }
    }
});

owl2.owlCarousel({
    touchDrag:true,
    loop: true,
    dots: false,
    nav: false,
    margin: 30,
    onInitialized: carouselInitialized2,
    responsive: {
        0 : {
            items : 1.1480263,
            margin: 10
        },
        500 : {
            items : 1.5,
            margin: 20
        },
        600 : {
            items : 1.8,
            margin: 20
        },
        768 : {
            items : 1.5455057,
            margin: 20
        },
        900 : {
            items : 1.8
        },/*
        1100 : {
            items : 2
        },*/
        1300 : {
            items : 2.3586206
        },
        1800 : {
            items : 2.36434108
        }
    }
});

owl3.owlCarousel({
    touchDrag:true,
    loop: true,
    dots: false,
    nav: false,
    margin: 20,
    onInitialized: carouselInitialized3,
    responsive: {
        0 : {
            items : 1
        },
        351 : {
            items : 2.14
        },
        801 : {
            items : 2.5
        },
        901 : {
            items : 2.8
        },
        1001 : {
            items : 3.1185
        },
        1800 : {
            items : 3.7051671
        }
    }
});


if (!document.getElementById('rent-banner')) {
    owl4.owlCarousel({
        touchDrag: true,
        loop: true,
        dots: false,
        nav: false,
        responsive: {
            0 : {
                items : 2.35,
                margin: 10
            },
            600 : {
                items : 2.35,
                margin: 20
            },
            1150 : {
                items : 1.25
            }
        }
    });
} else {
    owl4.owlCarousel({
        touchDrag: true,
        loop: true,
        dots: false,
        nav: false,
        responsive: {
            0 : {
                items : 2.35,
                margin: 10
            },
            600 : {
                items : 2.35,
                margin: 20
            },
            1150 : {
                items : 1.37
            },
            1800 : {
                items : 1.25
            }
        }
    });
}

$('#banner-arrow').click(function(){
    $('#banner-slider').trigger('next.owl');
});

if (document.getElementById('banner-slider')) {
    let len = document.getElementById('banner-slider').children.length;
    let num_active = $("#banner-slider > .active:first").index(this);
}

owl4.on('initialize.owl.carousel', function(e) {
    if (!e.namespace || e.property.name != 'position') return;

    let item_index  = e.item.index-e.item.count+2;
    $('#banner-current').html(item_index);

    if (e.page.count < 10)
        $('#banner-all').html('0' + e.item.count);
    else
        $('#banner-all').html(e.item.count);
    
});

$(document).ready(function(){
    $('#banner-slider').trigger('next.owl');
    $('#banner-slider').trigger('prev.owl');
});

owl4.on('changed.owl.carousel', function(e) {
    if (!e.namespace || e.property.name != 'position') return;

    let item_index  = e.item.index-2;
    if (item_index == e.item.count+1) item_index = 1;

    if (item_index < 10)
        $('#banner-current').html('0' + item_index);
    else
        $('#banner-current').html(item_index);

    if (e.page.count < 10)
        $('#banner-all').html('0' + e.item.count);
    else
        $('#banner-all').html(e.item.count);
});


owl4.on('changed.owl.carousel', function(e) {
    if (!e.namespace || e.property.name != 'position') return;

    let item_index  = e.item.index-2;
    if (item_index == e.item.count+1) item_index = 1;

    if (item_index < 10)
        $('#banner-current').html('0' + item_index);
    else
        $('#banner-current').html(item_index);

    if (e.page.count < 10)
        $('#banner-all').html('0' + e.item.count);
    else
        $('#banner-all').html(e.item.count);
});

$('.services__tabs-wrap').click(function(){
    $('.services__tabs-wrap').removeClass('active-tab-item');
    $(this).addClass('active-tab-item');
    $('.services__tab').removeClass('active-tab');
    $('#tab-content-' + $(this).attr('id').toString().slice(-1)).addClass('active-tab');
});

$('.modal-form__close').on('click', function() {
    $('.modal-form').hide();
});

$('.call-button').on('click', function() {
    $('.modal-form').show();
});

$('.mobile-menu__sublist').css('display','none');

$('.header__burger').on('click', function() {
    $('.modal-menu').css('display','flex');
    $(this).toggleClass('cross-mobile');
    $('.modal-menu').toggleClass('show');
    if (!$(".modal-menu").hasClass("show")) $('.modal-menu').css('display','none');
    /*if ($('.mobile-menu__list').css('display') == 'block') $('.mobile-menu__list').css('display','none');
        else if ($('.mobile-menu__sublist').css('display') == 'none') $('.mobile-menu__list').css('display','block');
    $('.mobile-menu__sublist').css('display','none');*/
});
$('#menu-item-125').hover(function() {
    $('.modal-menu').css('display','none');
    $('#modal-menu-arenda').css('display','flex');
});
$('#menu-item-1737').hover(function() {
    $('.modal-menu').css('display','none');
    $('#modal-menu-services').css('display','flex');
});
$('#menu-item-121').hover(function() {
    $('.modal-menu').css('display','none');
    $('#modal-menu-spare').css('display','flex');
});
$('#menu-item-1950').hover(function() {
    $('.modal-menu').css('display','none');
    $('#modal-menu-about').css('display','flex');
});
$('.modal-menu__close').on('click', function() {
    $('.modal-menu').css('display','none');
});

$(document).mouseup(function (e){
    let div = $(".modal-form");
    if (!div.is(e.target)
        && div.has(e.target).length === 0) {
        $(".modal-form").hide();
    }
});

let box1 = document.getElementById("services-box-1");
let box2 = document.getElementById("services-box-2");
let box3 = document.getElementById("services-box-3");
let box4 = document.getElementById("services-box-4");
let box5 = document.getElementById("services-box-5");
let box6 = document.getElementById("services-box-6");
let box7 = document.getElementById("services-box-7");
let box8 = document.getElementById("services-box-8");
let box9 = document.getElementById("services-box-9");
let box1Hover;
let box2Hover;
let box3Hover;
let box4Hover;
let box5Hover;
let box6Hover;
let box7Hover;
let box8Hover;
let box9Hover;

if (box1) {
box1.addEventListener("mouseleave", function (event) {
  box1Hover = false;
}, false);

box1.addEventListener("mouseover", function (event) {
  box1Hover = true;
}, false);

box2.addEventListener("mouseleave", function (event) {
  box2Hover = false;
}, false);

box2.addEventListener("mouseover", function (event) {
  box2Hover = true;
}, false);

box3.addEventListener("mouseleave", function (event) {
  box3Hover = false;
}, false);

box3.addEventListener("mouseover", function (event) {
  box3Hover = true;
}, false);

box4.addEventListener("mouseleave", function (event) {
  box4Hover = false;
}, false);

box4.addEventListener("mouseover", function (event) {
  box4Hover = true;
}, false);

box5.addEventListener("mouseleave", function (event) {
  box5Hover = false;
}, false);

box5.addEventListener("mouseover", function (event) {
  box5Hover = true;
}, false);

box6.addEventListener("mouseleave", function (event) {
  box6Hover = false;
}, false);

box6.addEventListener("mouseover", function (event) {
  box6Hover = true;
}, false);

box7.addEventListener("mouseleave", function (event) {
  box7Hover = false;
}, false);

box7.addEventListener("mouseover", function (event) {
  box7Hover = true;
}, false);

box8.addEventListener("mouseleave", function (event) {
  box8Hover = false;
}, false);

box8.addEventListener("mouseover", function (event) {
  box8Hover = true;
}, false);

box9.addEventListener("mouseleave", function (event) {
  box9Hover = false;
}, false);

box9.addEventListener("mouseover", function (event) {
  box9Hover = true;
}, false);

document.addEventListener('mousemove', e => {
    if (box1Hover) {
        services_img_1.style.left = e.pageX + "px";
        services_img_1.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box2Hover) {
        services_img_2.style.left = e.pageX + "px";
        services_img_2.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box3Hover) {
        services_img_3.style.left = e.pageX + "px";
        services_img_3.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box4Hover) {
        services_img_4.style.left = e.pageX + "px";
        services_img_4.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box5Hover) {
        services_img_5.style.left = e.pageX + "px";
        services_img_5.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box6Hover) {
        services_img_6.style.left = e.pageX + "px";
        services_img_6.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box7Hover) {
        services_img_7.style.left = e.pageX + "px";
        services_img_7.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box8Hover) {
        services_img_8.style.left = e.pageX + "px";
        services_img_8.style.top = e.pageY + "px";
    }
});

document.addEventListener('mousemove', e => {
    if (box9Hover) {
        services_img_9.style.left = e.pageX + "px";
        services_img_9.style.top = e.pageY + "px";
    }
});
}

owl1.on('changed.owl.carousel', function(e) {
    let item_index  = e.item.index - bar_dif1;
    if (item_index == e.item.count) item_index = 0;
    $('.posts__scroller').css('margin-left',  (100 - (100/(e.item.count)))/(e.item.count) * item_index  + '%');
});

function carouselInitialized1(e){
    bar_dif1 = e.item.index;
    $('.posts__scroller').css('width',  100/(e.item.count)*2 + '%');
}

owl2.on('changed.owl.carousel', function(e) {
    let item_index  = e.item.index - bar_dif2;
    if (item_index == e.item.count) item_index = 0;
    $('.reviews__scroller').css('margin-left',  (100 - (100/(e.item.count)))/(e.item.count) * item_index  + '%');
});

function carouselInitialized2(e){
    bar_dif2 = e.item.index;
    $('.reviews__scroller').css('width',  100/(e.item.count)*2 + '%');
}

owl3.on('changed.owl.carousel', function(e) {
    let item_index  = e.item.index - bar_dif3;
    if (item_index == e.item.count) item_index = 0;
    $('.similar__scroller').css('margin-left',  (100 - (100/(e.item.count)))/(e.item.count) * item_index  + '%');
});

function carouselInitialized3(e){
    bar_dif3 = e.item.index;
    $('.similar__scroller').css('width',  100/(e.item.count)*2 + '%');
}

$('.menu-toggle-button').on('click', function() {
    $(this).parent().find('ul').slideToggle();
    $(this).parent().find('ul').css('display','block');
    $(this).parent().find('svg').toggleClass('reversed');
});

$('.mob-menu-item-wrap span').on('click', function() {
    $('.mobile-menu__list').css('display','none');
    $('.mobile-menu__sublist').css('display','block');
});

$('.modal-menu__sublist-title').on('click', function() {
    $('#menu-header-menu-2').css('display','block');
    $('.mobile-menu__sublist').css('display','none');
});


let form = document.getElementById('form1');
if (form) {
    form.noValidate = true;
    form.addEventListener('submit', function(event) {
        event.preventDefault();
        $('#form1-name-wrap').removeClass('invalid-input');
        $('#form1-phone-wrap').removeClass('invalid-input');
        if (!event.target.checkValidity()) {
            let name = document.getElementById('form1-name');
            if (!name.checkValidity()) {
                $('#form1-name-wrap').addClass('invalid-input');
            }
            let phone = document.getElementById('form1-phone');
            if (!phone.checkValidity()) {
                $('#form1-phone-wrap').addClass('invalid-input');
            }
        } else {
            $('.consultation-form__title').text('Спасибо за вашу заявку!');
            $('.data-checkbox-label').css('visibility','hidden');
            $('.consultation-form__group').css('visibility','hidden');
            $('.consultation-form__title').addClass('accepted');
        }
    }, false);
}


let form2 = document.getElementById('form2');
if (form2) {
    form2.noValidate = true;
    form2.addEventListener('submit', function(event) {
        event.preventDefault();
        $('#form2-name-wrap').removeClass('invalid-input');
        $('#form2-phone-wrap').removeClass('invalid-input');
        if (!event.target.checkValidity()) {
            let name = document.getElementById('form2-name');
            if (!name.checkValidity()) {
                $('#form2-name-wrap').addClass('invalid-input');
            }
            let phone = document.getElementById('form2-phone');
            if (!phone.checkValidity()) {
                $('#form2-phone-wrap').addClass('invalid-input');
            }
        } else {
            $('.feedback__title').text('Спасибо за вашу заявку!');
            $('#form2').css('visibility','hidden');
            $('.feedback__title').addClass('accepted');
        }
    }, false);
}
if (document.getElementById('catalog-block')) {
    document.getElementsByClassName('catalog__list-button')[0].addEventListener('click', function() {
        document.getElementsByClassName('catalog__list-button')[0].classList.add("active-grid-item");
        document.getElementsByClassName('catalog__cards-button')[0].classList.remove("active-grid-item");
        document.getElementsByClassName('catalog__items')[0].classList.add("catalog__list-items");
        Array.prototype.map.call(document.getElementsByClassName('catalog__card'), function(e) {
            e.classList.add("catalog__list-item");
        });
    });

    document.getElementsByClassName('catalog__cards-button')[0].addEventListener('click', function() {
        document.getElementsByClassName('catalog__list-button')[0].classList.remove("active-grid-item");
        document.getElementsByClassName('catalog__cards-button')[0].classList.add("active-grid-item");
        document.getElementsByClassName('catalog__items')[0].classList.remove("catalog__list-items");
        Array.prototype.map.call(document.getElementsByClassName('catalog__card'), function(e) {
            e.classList.remove("catalog__list-item");
        });
    });

    $(".custom-select").each(function() {
      let classes = $(this).attr("class"),
          id      = $(this).attr("id"),
          name    = $(this).attr("name");
      let template =  '<div class="' + classes + '">';
          if ($(location).attr('href').indexOf('orderby=price&order=asc') != -1) {
            template += '<span class="custom-select-trigger">' + $(this).attr("placeholder") + '</span>';
          } else {
            if ($(location).attr('href').indexOf('orderby=price&order=desc') != -1) {
              template += '<span class="custom-select-trigger">' + $(this).attr("placeholder") + '</span>';
            } else {
                template += '<span class="custom-select-trigger">' + $(this).attr("placeholder") + '</span>';
            }
          }
          template += '<div class="custom-options">';
          $(this).find("option").each(function() {
             if ($(location).attr('href').indexOf('?') != -1) {
                 if ($(location).attr('href').indexOf('orderby') != -1) {
                     template += '<a id=' + $(this).attr('id') + ' href="' + $(location).attr('href').substr(0, $(location).attr('href').indexOf('orderby')) + $(this).attr('value') +'"><span class="custom-option">' + $(this).html() + '</span></a>';
                 } else {
                    template += '<a id=' + $(this).attr('id') + ' href="' + $(location).attr('href') + '&' + $(this).attr('value') +'"><span class="custom-option">' + $(this).html() + '</span></a>';
                 }
             } else {
                 template += '<a id=' + $(this).attr('id') + ' href="?' + $(this).attr('value') +'"><span class="custom-option">' + $(this).html() + '</span></a>';
             }
          });
      template += '</div></div>';
      
      $(this).wrap('<div class="custom-select-wrapper"></div>');
      $(this).hide();
      $(this).after(template);
    });
    $(".custom-option:first-of-type").hover(function() {
      $(this).parents(".custom-options").addClass("option-hover");
    }, function() {
      $(this).parents(".custom-options").removeClass("option-hover");
    });
    $(".custom-select-trigger").on("click", function() {
      $('html').one('click',function() {
        $(".custom-select").removeClass("opened");
      });
      $(this).parents(".custom-select").toggleClass("opened");
      event.stopPropagation();
    });
    $(".custom-option").on("click", function() {
      $(this).parents(".custom-select-wrapper").find("select").val($(this).data("value"));
      $(this).parents(".custom-options").find(".custom-option").removeClass("selection");
      $(this).addClass("selection");
      $(this).parents(".custom-select").removeClass("opened");
      //$(this).parents(".custom-select").find(".custom-select-trigger").text($(this).text());
    });
    if ($(location).attr('href').indexOf('orderby=price&order=asc') != -1) {
        $('#select-sort-price-asc > .custom-option').addClass('selected');
    }   
    if ($(location).attr('href').indexOf('orderby=price&order=desc') != -1) {
        $('#select-sort-price-desc > .custom-option').addClass('selected');
    }
    if ($(location).attr('href').indexOf('orderby=popularity&order=desc') != -1) {
        $('#select-sort-popularity > .custom-option').addClass('selected');
    }   
}

let target = $('.conditions__counter');
if (target.offset()) {
    let targetPos = target.offset().top;
    let winHeight = $(window).height();
    let scrollToElem = targetPos - winHeight;
    let isHappened = false;
    $(window).scroll(function(){
      let winScrollTop = $(this).scrollTop();
      if(winScrollTop > scrollToElem){
        if (!isHappened) {
            $('.conditions__counter').each(function () {
                $(this).prop('Counter',0).animate({
                    Counter: $(this).text()
                }, {
                    duration: 1000,
                    easing: 'swing',
                    step: function (now) {
                        $(this).text(Math.ceil(now));
                    }
                });
            });
            isHappened = true;
        }
      }
    });
}
$('.catalog__filter-button').on('click', function() {
    $('.modal-filter').css('display','flex');
    $('.modal-filter').toggleClass('show');
    if (!$(".modal-filter").hasClass("show")) $('.modal-filter').css('display','none');
});

$('.modal-filter__close').on('click', function() {
    $('.modal-filter').removeClass('show');
    $('.modal-filter').css('display','none');
});

$('.catalog__navigation > ul > li.active-catalog-filter > a').parent().find('ul').css('display','block');//.slideToggle();

$('.catalog__navigation > ul > li.active-catalog-filter > a').on('click', function() {
    //
    //$(this).parent().find('ul').slideToggle();
    if ( $(this).parent().find('ul').css('display') == 'block' )
        $(this).parent().find('ul').css('display','none');
    else
        $(this).parent().find('ul').css('display','block');
    //$(this).parent().find('ul').css('display','block');
    $(this).parent().toggleClass('active-catalog-filter');
});

$('.construction-services-search__radio').on('click', function() {
    let text = $(this).parent().find('.construction-services-search__label').text();
    if ($(this).hasClass('active-radio')) {
        $('.construction-services-search__active-filters').children().each(function() {
            let currentElement = $(this);
            if (currentElement.text() == text) {
                $(this).remove();
            }
        });
    } else {
        $('.construction-services-search__active-filters').append('<div class="construction-services-search__active-filter" title="' + $(this).parent().attr( "title" ) + '"><span>' + $(this).parent().find('.construction-services-search__label').text()  + '</span><svg class="filter__cross" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L9 9M9 1L1 9" stroke="#202022"/></svg></div>');
    }
    $(this).toggleClass('active-radio');
});

$('.construction-services-search__label').on('click', function() {
    let text = $(this).text();
    if ($(this).parent().find('.construction-services-search__radio').hasClass('active-radio')) {
        $('.construction-services-search__active-filters').children().each(function() {
            let currentElement = $(this);
            if (currentElement.text() == text) {
                $(this).remove();
            }
        });
    } else {
        $('.construction-services-search__active-filters').append('<div class="construction-services-search__active-filter" title="' + $(this).parent().attr( "title" ) + '"><span>' + $(this).text()  + '</span><svg class="filter__cross" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L9 9M9 1L1 9" stroke="#202022"/></svg></div>');
    }
    $(this).parent().find('.construction-services-search__radio').toggleClass('active-radio');
});

/*$(".construction-services-search__active-filters").on("click", ".filter__cross", function(){
    let text = $(this).parent().find('span').text();
    $('.construction-services-search__select > ul').children().each(function() {
        let currentElement = $(this);
        if (currentElement.find('span').text() == text) {
            currentElement.find('div').removeClass('active-radio');
        }
    });
    $(this).parent().remove();
});*/

window.onload = function() {
    function scrolling() {
        let target2 = $('.product-page__info');
        let target2_1 = $('.product-page__characteristics');
        let target2_2 = $('.product-page__conditions');
        let target2_3 = $('.product-page__similar');
        let target2_4 = $('.product-page__reviews');
        let target3_1 = $('#art_info_target');
        let target3_2 = $('#art_varieties_target');
        let target3_3 = $('#art_application_target');
        let target3_4 = $('#art_difference_target');
        let target3_5 = $('#art_options_target');
        let target3_6 = $('#art_statistics_target');

        if (target2.offset()) {
            let targetPos = target2.offset().top;
            let targetPos1 = target2_1.offset().top;
            let targetPos2 = target2_2.offset().top;
            let targetPos3 = target2_3.offset().top;
            let targetPos4 = target2_4.offset().top;
            let winHeight = $(window).height();
            let scrollToElem = targetPos - winHeight/4.5;
            let scrollToElem1 = targetPos1 - winHeight/2;
            let scrollToElem2 = targetPos2 - winHeight/2;
            let scrollToElem3 = targetPos3 - 800;
            let scrollToElem4 = targetPos4 - winHeight/2;
            let isHappened = false;
            $(window).scroll(function(){
                let winScrollTop = $(this).scrollTop();
                console.log(scrollToElem3);
                if(winScrollTop > scrollToElem && winScrollTop < scrollToElem3) {
                    $('.product-page__nav-wrap').css({
                        'position': 'fixed',
                        'top': '230px'
                    });
                    /*if (!isHappened) {
                        $('.product-page__nav-wrap').css({
                            'position' : 'sticky'
                        });
                        isHappened = true;
                    }*/
                } else {
                    $('.product-page__nav-wrap').css({
                        'position': 'absolute',
                        'top': '0'
                    });
                }
                if(winScrollTop > scrollToElem4) {
                    $('.product-page__nav-fill').css({
                        'height': '316px'
                    });
                } else {
                    if(winScrollTop > scrollToElem2) {
                        $('.product-page__nav-fill').css({
                            'height': '240px'
                        });
                    } else {
                        if(winScrollTop > scrollToElem1) {
                            $('.product-page__nav-fill').css({
                                'height': '146px'
                            });
                        } else {
                            $('.product-page__nav-fill').css({
                                'height': '63px'
                            });
                        }
                    }
                }
            });
        }

        $('#st_description').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2.offset().top-160
            }, 500);
        });
        $('#st_characteristics').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_1.offset().top-160
            }, 500);
        });
        $('#st_conditions').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_2.offset().top-160
            }, 500);
        });
        $('#st_reviews').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_4.offset().top-160
            }, 500);
        });


        $('#st_description_1').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2.offset().top-160
            }, 500);
        });
        $('#st_characteristics_1').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_1.offset().top-160
            }, 500);
        });
        $('#st_conditions_1').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_2.offset().top-160
            }, 500);
        });
        $('#st_reviews_1').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_4.offset().top-160
            }, 500);
        });

        $('.st_description_2').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2.offset().top-160
            }, 500);
        });
        $('.st_characteristics_2').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_1.offset().top-160
            }, 500);
        });
        $('.st_conditions_2').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_2.offset().top-160
            }, 500);
        });
        $('.st_reviews_2').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target2_4.offset().top-160
            }, 500);
        });

        $('#art_info').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target3_1.offset().top-160
            }, 500);
        });
        $('#art_varieties').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target3_2.offset().top-160
            }, 500);
        });
        $('#art_application').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target3_3.offset().top-160
            }, 500);
        });
        $('#art_difference').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target3_4.offset().top-160
            }, 500);
        });
        $('#art_options').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target3_5.offset().top-160
            }, 500);
        });
        $('#art_statistics').on('click', function() {
            $([document.documentElement, document.body]).animate({
                scrollTop: target3_6.offset().top-160
            }, 500);
        });
    };

    setTimeout(scrolling, 1000);
}

let cords = ['scrollX','scrollY'];

if (localStorage.getItem('scrollCatalog') == 'true') {
    window.scroll(...cords.map(cord => localStorage[cord]));
    localStorage.setItem('scrollCatalog', false);
}

$('.catalog__navigation > ul > li > a').on('click', function() {
    window.addEventListener('unload', e => cords.forEach(cord => localStorage[cord] = window[cord]));
    localStorage.setItem('scrollCatalog', true);
});

$('.custom-option').on('click', function() {
    window.addEventListener('unload', e => cords.forEach(cord => localStorage[cord] = window[cord]));
    localStorage.setItem('scrollCatalog', true);
});

$('.catalog__subitems > li > a').on('click', function() {
    window.addEventListener('unload', e => cords.forEach(cord => localStorage[cord] = window[cord]));
    localStorage.setItem('scrollCatalog', true);
});

$('.page-numbers, .catalog__search-group button').on('click', function() {
    $([document.documentElement, document.body]).animate({
        scrollTop: $('.catalog__title').offset().top-160
    }, 50);
    
    window.addEventListener('unload', e => cords.forEach(cord => localStorage[cord] = window[cord]));
    localStorage.setItem('scrollCatalog', true);
});

jQuery(function($){
    $('#filter').submit(function(){
        var filter = $('#filter');
        $.ajax({
            url:filter.attr('action'),
            data:filter.serialize(), // form data
            type:filter.attr('method'), // POST
            beforeSend:function(xhr){
                filter.find('button').text('Processing...'); // changing the button label
            },
            success:function(data){
                filter.find('button').text('Apply filter'); // changing the button label back
                $('#loop').html(data); // insert data
            }
        });
        return false;
    });
});

$( ".article__content h3" ).each(function() {
	$('.article__nav').append('<li>' + $(this).text() + '</li>');
});

$('.article__nav li').on('click', function() {
	let current = $(this).text();
	let target;
	$( ".article__content h3" ).each(function() {
		if ($(this).text() == current) {
			target = $(this);
		}
	});
	$([document.documentElement, document.body]).animate({
		scrollTop: target.offset().top-160
	}, 500);
});

if ($( ".article__content img" ).length > 3) {
	$('.article__gallery').css('display','block');
	$( ".article__content img" ).each(function() {
	  $( '#article-gallery' ).append( '<div class="post-img" style="background: url(' + $(this).attr('src') + ') no-repeat center grey; background-size: cover;"></div>' );
	});
}

owl6.owlCarousel({
    touchDrag:true,
    loop: true,
    dots: false,
    nav: false,
    margin: 30,
    onInitialized: carouselInitialized1,
    responsive: {
        0 : {
            items : 1.1480263,
            margin: 10
        },
        500 : {
            items : 1.5,
            margin: 20
        },
        600 : {
            items : 1.8,
            margin: 20
        },
        768 : {
            items : 2.3355932,
            margin: 20
        },
        900 : {
            items : 2.55
        },/*
        1100 : {
            items : 3
        },*/
        1300 : {
            items : 2.3586206
        },
        1800 : {
            items : 2.2472527
        }
    }
});

owl7.owlCarousel({
	touchDrag:true,
	loop: true,
	dots: false,
	nav: false,
    autoWidth:true,
	items: 4
});

$('#commentform textarea').on('mousedown', function() {
	 $('#commentform').addClass('open-comment');
});

$('#commentform #submit').attr('disabled','true');

$('#commentform textarea').on('input propertychange paste', function() {
	if ($("textarea").val().trim() !== '') {
		$('#commentform #submit').addClass('comments-active-button');
		$('#commentform #submit').removeAttr('disabled');
		$('#commentform textarea').css('z-index','3');
	} else {
		$('#commentform #submit').removeClass('comments-active-button');
		$('#commentform textarea').css('z-index','1');
	}
});

$(document).mouseup(function (e){
    let div = $("#commentform");
    if (!div.is(e.target)
        && div.has(e.target).length === 0) {
        $("#commentform").removeClass('open-comment');
    }
	
	let div2 = $(".modal-social-auth");
    if (!div2.is(e.target)
        && div2.has(e.target).length === 0) {
        $(".fade").css('display','none');
    }
});

$('.modal-social-auth__close-button').click(function() {
	$(".fade").css('display','none');
});

$('.article__comments-auth > a').click(function(event) {
	event.preventDefault();
	$(".fade").css('display','block');
});


document.addEventListener("DOMContentLoaded", function () {
    var eventCalllback = function (e) {
        var el = e.target,
            clearVal = el.dataset.phoneClear,
            pattern = el.dataset.phonePattern,
            matrix_def = "+375 (__) ___-__-__",
            matrix = pattern ? pattern : matrix_def,
            i = 0,
            def = matrix.replace(/\D/g, ""),
            val = e.target.value.replace(/\D/g, "");
        if (clearVal !== 'false' && e.type === 'blur') {
            if (val.length < matrix.match(/([\_\d])/g).length) {
                e.target.value = '';
                return;
            }
        }
        if (def.length >= val.length) val = def;
        e.target.value = matrix.replace(/./g, function (a) {
            return /[_\d]/.test(a) && i < val.length ? val.charAt(i++) : i >= val.length ? "" : a
        });
    }
    var phone_inputs = document.querySelectorAll('input[type="tel"]');
    for (let elem of phone_inputs) {
        for (let ev of ['input', 'blur', 'focus']) {
            elem.addEventListener(ev, eventCalllback);
        }
    }
});